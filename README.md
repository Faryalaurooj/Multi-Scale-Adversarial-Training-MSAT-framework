
# MSAT Framework

This repository contains the **Multi-Scale Adversarial Training (MSAT)** framework for enhancing object detection in remote sensing through a combination of real and synthetically augmented data.

MSAT integrates a SinGAN-based generator for creating high-fidelity augmentations, a Realism Discriminator for assessing data quality, and a Multi-Scale Attention (MSA) module to improve feature relevance during detection.

![hybrid](https://github.com/user-attachments/assets/f8784eda-2e4c-4a2b-99ad-3b2e7cae9fff)
![flowdiagram_complete](https://github.com/user-attachments/assets/fd1fcbe4-37b6-4760-9f8d-b32f41d542b4)




### ✨ Features

- ✅ SinGAN-based realistic augmentation of remote sensing imagery  
- ✅ Realism Discriminator for filtering low-quality synthetic data  
- ✅ Multi-Scale Attention (MSA) for enhanced feature extraction  
- ✅ Compatible with hybrid (real + synthetic) datasets  
- ✅ Evaluated on multiple real-world aerial/satellite datasets  



### 📁 Directory Structure

```
MSAT-Framework/
├── main.py                  # Entry point for training and evaluation
├── train_gan.py             # Script to train SinGAN on real samples
├── dataset.py               # Dataset loader and pre-processing
├── config.yaml              # Configurations for model and training
├── README.md                # Project overview and instructions
├── utils/
│   └── singan_wrapper.py    # Wrapper for SinGAN integration
├── models/
│   ├── discriminator.py     # Realism Discriminator definition
│   └── msa_module.py        # Multi-Scale Attention module
├── data/
│   ├── real/                # Folder for real imagery
│   └── synthetic/           # Folder for SinGAN-generated samples
├── outputs/
│   └── generated_samples/   # Output directory for synthetic data
```

---

### ⚙️ Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/MSAT-Framework.git
   cd MSAT-Framework
   ```

2. Install dependencies (Python 3.8+ recommended):
   ```bash
   pip install -r requirements.txt
   ```

3. (Optional) Set up a virtual environment:
   ```bash
   python -m venv msat_env
   source msat_env/bin/activate
   ```



### 🚀 Commands

#### Train SinGAN on Real Imagery
```bash
python train_gan.py --input_dir ./data/real --output_dir ./data/synthetic
```

#### Train MSAT Detection Pipeline
```bash
python main.py --config config.yaml
```

#### Evaluate on Real/Test Dataset
```bash
python main.py --config config.yaml --mode eval
```



### ⚒️ Configuration

Edit `config.yaml` to control:

- Dataset paths
- Training parameters
- GAN and Discriminator options
- MSA module settings



### 📊 Results

MSAT has been evaluated on several aerial datasets. It demonstrates improved F1-scores and detection robustness over baseline YOLOv8 and other models, especially when trained with hybrid datasets.

| Model     | Dataset       | F1-Score | Precision | Recall |
|-----------|---------------|----------|-----------|--------|
| YOLOv8    | xView         | 0.72     | 0.70      | 0.74   |
| **MSAT**  | xView         | **0.82** | **0.80**  | **0.85** |
| MSAT + MSA | Custom Hybrid | **0.87** | **0.86**  | **0.89** |



### 🧪 Dataset Notes

- Real images are stored under `data/real/`
- Synthetic images generated by SinGAN are stored in `data/synthetic/`
- You can mix datasets by modifying the loader in `dataset.py`



### 🤝 Contributions

Feel free to fork the repo and submit pull requests for:

- New dataset adapters
- Performance improvements
- Integration with other backbones (YOLOv9, Faster-RCNN)



